// 가격 및 예측 데이터 전용 데이터베이스 스키마
// 별도 Railway MySQL 서버에서 운영

generator client {
  provider = "prisma-client-js"
  output   = "../lib/generated/prisma-price"
}

datasource db {
  provider = "mysql"
  url      = env("PRICE_DATABASE_URL")
}

// 실시간 가격 정보
model RealTimePrice {
  id           String   @id @default(cuid())
  asset        String   @unique
  currentPrice Float
  changeValue  Float
  changeRatio  Float
  isUp         Int
  round        String
  time         String
  rawDateTime  String
  updatedAt    DateTime @default(now()) @updatedAt
  createdAt    DateTime @default(now())

  @@map("real_time_prices")
}

// 일별 가격 정보
model DailyPrice {
  id        String   @id @default(cuid())
  asset     String
  date      String
  close     Float
  diff      Float
  ratio     Float
  createdAt DateTime @default(now())

  @@unique([asset, date])
  @@index([asset, date])
  @@map("daily_prices")
}

// 차트용 가격 정보
model ChartPrice {
  id          String   @id @default(cuid())
  asset       String
  price       Float
  degreeCount Int
  dateTime    String
  createdAt   DateTime @default(now())

  @@unique([asset, dateTime, degreeCount], name: "asset_dateTime_degreeCount")
  @@index([asset, dateTime])
  @@map("chart_prices")
}

// 금 가격 예측 결과
model GoldPrediction {
  id                String   @id @default(cuid())
  asset             String   @default("gold")
  predictionDate    String // 예측 날짜 (YYYY-MM-DD)
  direction         String // 상승/하락
  confidence        Float // 신뢰도 (0.0 ~ 1.0)
  probability       Float // 예측 확률 (0.0 ~ 1.0)
  nextDayPrediction Int // 다음날 예측 (1: 상승, 0: 하락)
  basedOnDays       Int // 분석 기간 (일수)
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  @@unique([asset, predictionDate])
  @@index([predictionDate])
  @@map("gold_predictions")
}
